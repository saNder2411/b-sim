{"version":3,"sources":["app/websockets.cljs"],"mappings":";AAGA,GAAA,QAAAA,gCAAAC,2CAAAC;AAAA;AAAA,AAAA,AAASC,yBAAQ,6CAAA,7CAACC;;AAElB,+BAAA,/BAAMC,sEAAUC,IAAIC;AAApB,AACE,IAAAC,qBAAY,KAAAE,UAAeJ;AAA3B,AAAA,oBAAAE;AAAA,SAAAA,LAASC;AAAT,AACE,AACE,YAAA,ZAACE;;AACD,gBAAA,WAAAC,1BAAM,AAAaH;AAAnB,AAAwB,IAAAI,WAAA,sDAAA,AAAAD,tDAEKE;AAFL,AAAA,oGAAAD,qCAAAA,jIAGKN,+CAAAA,yDAAAA;;;AAC7B,OAACQ,sBAAOZ,uBAAQM;;AAClB,MAAO,gDAAA,+BAAA,2CAAA,1HAACO,4KAA6CV;;;AAEzD,oCAAA,pCAAMW,gFAAeC;AAArB,AACE,IAAAV,qBAAA,AAAAW,gBAAehB;AAAf,AAAA,oBAAAK;AAAA,WAAAA,PAASY;AAAT,AACE,OAAOA,UAAK,AAACC,wGAAOH;;AACpB,MAAO,gDAAA,6CAAA,2CAAA,xIAACF,mMAA+DE","names":["js/app","js/app.websockets","js/app.websockets.channel","app.websockets/channel","cljs.core.atom","app.websockets/connect!","url","receive-handle","temp__5802__auto__","ch","js/WebSocket","js/console.log","p1__28439#","G__28440","cljs.reader.read_string","cljs.core/reset!","cljs.core.ex_info","app.websockets/send-message!","msg","cljs.core/deref","chan","cljs.core.pr_str"],"sourcesContent":["(ns app.websockets\n  (:require [cljs.reader :as edn]))\n\n(defonce channel (atom nil))\n\n(defn connect! [url receive-handle]\n  (if-let [ch (js/WebSocket. url)]\n    (do\n      (js/console.log \"Connected!\")\n      (set! (.-onmessage ch) #(->> %\n                                   .-data\n                                   edn/read-string\n                                   receive-handle))\n      (reset! channel ch))\n    (throw (ex-info \"Websocket Connection Failed!\" {:url url}))))\n\n(defn send-message! [msg]\n  (if-let [chan @channel]\n    (.send chan (pr-str msg))\n    (throw (ex-info \"Couldn't send message, channel isn't open!\" {:message msg}))))\n"]}