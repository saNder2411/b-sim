{"version":3,"sources":["app/db/NRR_2_60_subs.cljs"],"mappings":";AAGA,iDAAA,jDAACA,8GACQ,WAAKC,GAAGC;AAAR,AACE,OAAA,2FAAWD;;AAEtB,+CAAA,/CAAKE;AACL,+CAAA,/CAAKC;AAEL,2CAAA,3CAAKC;AACL,2CAAA,3CAAKC;AACL,2CAAA,3CAAKC;AACL,iDAAA,jDAAKC;AAEL,4CAAA,5CAAMC,gGAAsBC,iBAAiBC;AAA7C,AACE,IAAMC,QAAM,8BAAA,7BAAG,CAAGF,mBAAiBC;AAAnC,AACE,GAAI,CAAGC,QAAMT;AACXA;;AACAS;;;AAEN,mBAAA,qFAAA,gDAAA,mFAAA,3OAACC,gTAEQ,WAAKC,SAASZ;AAAd,AACE,IAAAa,aAA+D,AAAA,iGAAcD;IAA7EC,iBAAA,AAAAC,4BAAAD;kBAAAA,dAAkDK;0BAAlD,AAAAH,4CAAAF,eAAA,jFAAcG;iBAAd,AAAAD,4CAAAF,eAAA,xEAAkCI;IAC5BE,uBAAqB,AAACZ,0CAAqBS,oBAAoBC;IAC/DG,4BAA0B,CAAGjB,2CAAoB,CAAGgB,uBAAqBb;AAF/E,AAGE,wEAAA,2JAAA,5NAACe,qDAAMH,gGAAkCC,uKACKC;;AAE3D,mBAAA,mHAAA,gDAAA,mFAAA,zQAACT,sWAEQ,WAAKW,IAAItB;AAAT,AACE,iEAAA,sIAAA,uDAAA,qFAAA,0FAAA,6GAAA,iFAAA,pmBAACuB,sDAAOD","names":["refx.alpha.reg_sub","db","_","app.db.NRR-2-60-subs/max-high-point-by-cal-p","app.db.NRR-2-60-subs/min-high-point-by-cal-p","app.db.NRR-2-60-subs/min-level-by-boiler","app.db.NRR-2-60-subs/max-level-by-boiler","app.db.NRR-2-60-subs/max-range-by-boiler","app.db.NRR-2-60-subs/%-in-digital-unit","app.db.NRR-2-60-subs/calc-real-high-point","h-point-by-cal-p","cal-p","value","refx.alpha/reg-sub","NRR-2-60","map__66353","cljs.core/--destructure-map","cljs.core.get","high-point-by-cal-p","next-cal-p","calibration","next-real-high-point","next-high-point-by-boiler","cljs.core.assoc","cal","cljs.core.dissoc"],"sourcesContent":["(ns app.db.NRR-2-60-subs\n  (:require [refx.alpha :refer [reg-sub]]))\n\n(reg-sub :NRR-2-60\n         (fn [db _]\n           (:NRR-2-60 db)))\n\n(def max-high-point-by-cal-p 32767)\n(def min-high-point-by-cal-p 8191.75)\n\n(def min-level-by-boiler 78.21877)                          ;%\n(def max-level-by-boiler 97.86859)\n(def max-range-by-boiler 19.64982)\n(def %-in-digital-unit 0.0005996832179)                     ;; one digital value includes 0.0005996832179 percent; 19.64982 % / 32767 digital units\n\n(defn calc-real-high-point [h-point-by-cal-p cal-p]\n  (let [value (* (/ h-point-by-cal-p cal-p) 100)]\n    (if (> value max-high-point-by-cal-p)\n      max-high-point-by-cal-p\n      value)))\n\n(reg-sub :NRR-2-60-calibration\n         :<- [:NRR-2-60]\n         (fn [NRR-2-60 _]\n           (let [{:keys [high-point-by-cal-p next-cal-p] :as calibration} (:calibration NRR-2-60)\n                 next-real-high-point (calc-real-high-point high-point-by-cal-p next-cal-p)\n                 next-high-point-by-boiler (+ min-level-by-boiler (* next-real-high-point %-in-digital-unit))]\n             (assoc calibration :next-real-high-point next-real-high-point\n                                :next-high-point-by-boiler next-high-point-by-boiler))))\n\n(reg-sub :NRR-2-60-calibration-level-cal-view\n         :<- [:NRR-2-60-calibration]\n         (fn [cal _]\n           (dissoc cal\n                   :high-point-by-cal-p\n                   :cal-p\n                   :opt-cal-p-from-modal\n                   :low-point->probe-value\n                   :high-point-by-cal-p->probe-value\n                   :cal-p->probe-value\n                   :next-cal-p)))\n\n"]}